<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ENI Ecole Informatique - R√©vision D2WM - Quiz Interactif</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- HEADER -->
    <header>
        <div class="container">
            <div class="header-content">
                <a href="#" class="logo" onclick="showPage('accueil')">Quiz D2WM</a>
                <nav>
                    <ul>
                        <li><a href="#" onclick="showPage('accueil')" class="nav-link active">Accueil</a></li>
                        <li><a href="#" onclick="showPage('quiz-setup')" class="nav-link">Quiz</a></li>
                        <li><a href="#" onclick="showPage('questions-list')" class="nav-link">Questions</a></li>
                    </ul>
                </nav>
            </div>
        </div>
    </header>

    <!-- MAIN CONTENT -->
    <main>
        <div class="container">
            <!-- PAGE ACCUEIL -->
            <div id="accueil" class="page active">
                <div class="welcome">
                    <h1>R√©vision D2WM</h1>
                    <p>Plateforme de r√©vision interactive pour les stagiaires en D√©veloppement logiciel BAC+2</p>
                    
                    <div class="menu-cards">
                        <div class="menu-card" onclick="showPage('quiz-setup')">
                            <h3>üéØ Quiz Interactif</h3>
                            <p>Testez vos connaissances avec des questions chronom√©tr√©es et obtenez des explications d√©taill√©es</p>
                        </div>
                        <div class="menu-card" onclick="showPage('questions-list')">
                            <h3>üìö Base de Questions</h3>
                            <p>Parcourez toutes les questions organis√©es par th√®me avec leurs r√©ponses compl√®tes</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- PAGE CONFIGURATION QUIZ -->
            <div id="quiz-setup" class="page">
                <h2>Configuration du Quiz</h2>
                <div class="quiz-setup">
                    <div class="form-group">
                        <label for="theme-select">Choisir un th√®me :</label>
                        <select id="theme-select">
                            <option value="all">Tous les th√®mes</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="question-count">Nombre de questions :</label>
                        <input type="number" id="question-count" min="1" max="50" value="10" placeholder="Nombre de questions">
                    </div>
                    
                    <div class="form-group">
                        <label for="time-limit">Temps par question (secondes) :</label>
                        <input type="number" id="time-limit" min="10" max="300" value="30" placeholder="Temps en secondes">
                    </div>
                    
                    <button class="btn" onclick="startQuiz()">Commencer le Quiz</button>
                </div>
            </div>

            <!-- PAGE QUIZ -->
            <div id="quiz" class="page">
                <div class="quiz-container">
                    <div class="quiz-header">
                        <div class="quiz-progress">
                            Question <span id="current-question">1</span> sur <span id="total-questions">10</span>
                        </div>
                        <div class="timer" id="timer">30</div>
                    </div>
                    
                    <div class="question-card">
                        <div class="question-title" id="question-text"></div>
                        <div class="answers" id="answers-container"></div>
                        <div class="explanation" id="explanation"></div>
                    </div>
                    
                    <div class="text-center">
                        <button class="btn hidden" id="next-btn" onclick="nextQuestion()">Question Suivante</button>
                    </div>
                </div>
            </div>

            <!-- PAGE R√âSULTATS -->
            <div id="results" class="page">
                <div class="results-container">
                    <h2>R√©sultats du Quiz</h2>
                    <div class="score-circle" id="score-circle">
                        <div class="score-text" id="score-text">0%</div>
                    </div>
                    
                    <div class="results-summary">
                        <div class="stat-card">
                            <div class="stat-number" id="correct-answers">0</div>
                            <div class="stat-label">Bonnes r√©ponses</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="incorrect-answers">0</div>
                            <div class="stat-label">Mauvaises r√©ponses</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="total-time">0s</div>
                            <div class="stat-label">Temps total</div>
                        </div>
                    </div>
                    
                    <div class="mt-2">
                        <button class="btn" onclick="showPage('quiz-setup')">Nouveau Quiz</button>
                        <button class="btn" onclick="showPage('accueil')" style="margin-left: 1rem;">Retour Accueil</button>
                    </div>
                </div>
            </div>

            <!-- PAGE LISTE DES QUESTIONS -->
            <div id="questions-list" class="page">
                <h2>Base de Questions par Th√®me</h2>
                <div class="questions-list" id="questions-container"></div>
            </div>
        </div>
    </main>

    <!-- FOOTER -->
    <footer>
        <div class="container">
            <p>&copy; 2024 Quiz D2WM - Plateforme de r√©vision pour stagiaires en d√©veloppement logiciel</p>
        </div>
    </footer>

    <script>
        // === DONN√âES ===
        const questionsData = {
            "HTML/CSS": [
                {
                    question: "Quelle balise HTML5 est utilis√©e pour d√©finir un contenu principal d'une page ?",
                    answers: ["<main>", "<content>", "<primary>", "<section>"],
                    correct: 0,
                    explanation: "La balise <main> est sp√©cifiquement con√ßue en HTML5 pour marquer le contenu principal d'un document, celui qui est directement li√© au sujet central de la page."
                },
                {
                    question: "Comment centrer un √©l√©ment horizontalement avec CSS Flexbox ?",
                    answers: ["justify-content: center", "align-items: center", "text-align: center", "margin: auto"],
                    correct: 0,
                    explanation: "justify-content: center permet de centrer les √©l√©ments flex horizontalement le long de l'axe principal du conteneur flex."
                },
                {
                    question: "Quelle propri√©t√© CSS permet de cr√©er des colonnes √©gales dans une grille ?",
                    answers: ["grid-template-columns: 1fr 1fr", "display: grid", "grid-gap: 10px", "grid-auto-rows: 1fr"],
                    correct: 0,
                    explanation: "grid-template-columns: 1fr 1fr cr√©e deux colonnes de taille √©gale, o√π 1fr repr√©sente une fraction de l'espace disponible."
                }
            ],
            "JavaScript": [
                {
                    question: "Comment d√©clarer une variable constante en JavaScript ES6+ ?",
                    answers: ["var myVar", "let myVar", "const myVar", "constant myVar"],
                    correct: 2,
                    explanation: "Le mot-cl√© 'const' permet de d√©clarer une variable constante qui ne peut pas √™tre r√©assign√©e apr√®s sa d√©claration initiale."
                },
                {
                    question: "Quelle m√©thode permet d'ajouter un √©l√©ment √† la fin d'un tableau ?",
                    answers: ["array.add()", "array.push()", "array.append()", "array.insert()"],
                    correct: 1,
                    explanation: "La m√©thode push() ajoute un ou plusieurs √©l√©ments √† la fin d'un tableau et retourne la nouvelle longueur du tableau."
                },
                {
                    question: "Comment v√©rifier si une variable est de type 'string' ?",
                    answers: ["typeof variable === 'string'", "variable.isString()", "variable instanceof String", "String.isString(variable)"],
                    correct: 0,
                    explanation: "L'op√©rateur typeof retourne le type de la variable sous forme de cha√Æne. Pour v√©rifier si c'est une string, on compare avec 'string'."
                }
            ],
            "Base de donn√©es": [
                {
                    question: "Quelle commande SQL permet de r√©cup√©rer tous les enregistrements d'une table ?",
                    answers: ["GET * FROM table", "SELECT * FROM table", "FETCH * FROM table", "RETRIEVE * FROM table"],
                    correct: 1,
                    explanation: "SELECT * FROM table est la syntaxe standard SQL pour r√©cup√©rer tous les enregistrements (toutes les colonnes) d'une table donn√©e."
                },
                {
                    question: "Qu'est-ce qu'une cl√© primaire en base de donn√©es ?",
                    answers: ["Un index sur une colonne", "Un identifiant unique pour chaque ligne", "Une contrainte de validation", "Une relation entre tables"],
                    correct: 1,
                    explanation: "Une cl√© primaire est un identifiant unique pour chaque ligne d'une table, elle ne peut pas √™tre nulle et doit √™tre unique."
                }
            ],
            "Algorithmes": [
                {
                    question: "Quelle est la complexit√© temporelle d'une recherche dans un tableau tri√© avec la recherche binaire ?",
                    answers: ["O(n)", "O(log n)", "O(n¬≤)", "O(1)"],
                    correct: 1,
                    explanation: "La recherche binaire a une complexit√© O(log n) car elle divise l'espace de recherche par 2 √† chaque it√©ration."
                },
                {
                    question: "Quel algorithme de tri a la meilleure complexit√© temporelle dans le cas moyen ?",
                    answers: ["Bubble Sort", "Insertion Sort", "Quick Sort", "Selection Sort"],
                    correct: 2,
                    explanation: "Quick Sort a une complexit√© moyenne de O(n log n), ce qui en fait l'un des algorithmes de tri les plus efficaces en moyenne."
                }
            ]
        };

        // === VARIABLES GLOBALES ===
        let currentQuiz = [];
        let currentQuestionIndex = 0;
        let score = 0;
        let timer = null;
        let timePerQuestion = 30;
        let totalTime = 0;
        let questionStartTime = 0;

        // === INITIALISATION ===
        document.addEventListener('DOMContentLoaded', function() {
            initializeThemeSelect();
            displayQuestionsList();
        });

        function initializeThemeSelect() {
            const select = document.getElementById('theme-select');
            const themes = Object.keys(questionsData);
            
            themes.forEach(theme => {
                const option = document.createElement('option');
                option.value = theme;
                option.textContent = theme;
                select.appendChild(option);
            });
        }

        // === NAVIGATION ===
        function showPage(pageId) {
            // Masquer toutes les pages
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            
            // Afficher la page demand√©e
            document.getElementById(pageId).classList.add('active');
            
            // Mettre √† jour la navigation
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // Arr√™ter le timer si on quitte le quiz
            if (pageId !== 'quiz' && timer) {
                clearInterval(timer);
                timer = null;
            }
        }

        // === QUIZ ===
        function startQuiz() {
            const selectedTheme = document.getElementById('theme-select').value;
            const questionCount = parseInt(document.getElementById('question-count').value);
            timePerQuestion = parseInt(document.getElementById('time-limit').value);
            
            // Pr√©parer les questions
            let availableQuestions = [];
            if (selectedTheme === 'all') {
                Object.values(questionsData).forEach(themeQuestions => {
                    availableQuestions.push(...themeQuestions);
                });
            } else {
                availableQuestions = [...questionsData[selectedTheme]];
            }
            
            // M√©langer et s√©lectionner les questions
            availableQuestions.sort(() => Math.random() - 0.5);
            currentQuiz = availableQuestions.slice(0, Math.min(questionCount, availableQuestions.length));
            
            // R√©initialiser les variables
            currentQuestionIndex = 0;
            score = 0;
            totalTime = 0;
            
            // Afficher le quiz
            showPage('quiz');
            displayQuestion();
        }

        function displayQuestion() {
            const question = currentQuiz[currentQuestionIndex];
            
            // Mettre √† jour l'en-t√™te
            document.getElementById('current-question').textContent = currentQuestionIndex + 1;
            document.getElementById('total-questions').textContent = currentQuiz.length;
            
            // Afficher la question
            document.getElementById('question-text').textContent = question.question;
            
            // Afficher les r√©ponses
            const answersContainer = document.getElementById('answers-container');
            answersContainer.innerHTML = '';
            
            question.answers.forEach((answer, index) => {
                const button = document.createElement('button');
                button.className = 'answer-btn';
                button.textContent = answer;
                button.onclick = () => selectAnswer(index);
                answersContainer.appendChild(button);
            });
            
            // Masquer l'explication et le bouton suivant
            document.getElementById('explanation').classList.remove('show');
            document.getElementById('next-btn').classList.add('hidden');
            
            // D√©marrer le timer
            questionStartTime = Date.now();
            startTimer();
        }

        function startTimer() {
            let timeLeft = timePerQuestion;
            const timerElement = document.getElementById('timer');
            
            timer = setInterval(() => {
                timerElement.textContent = timeLeft;
                
                if (timeLeft <= 5) {
                    timerElement.classList.add('warning');
                } else {
                    timerElement.classList.remove('warning');
                }
                
                if (timeLeft <= 0) {
                    clearInterval(timer);
                    selectAnswer(-1); // Temps √©coul√©
                }
                
                timeLeft--;
            }, 1000);
        }

        function selectAnswer(selectedIndex) {
            if (timer) {
                clearInterval(timer);
                timer = null;
            }
            
            const question = currentQuiz[currentQuestionIndex];
            const answersContainer = document.getElementById('answers-container');
            const buttons = answersContainer.querySelectorAll('.answer-btn');
            
            // Calculer le temps de r√©ponse
            const responseTime = Date.now() - questionStartTime;
            totalTime += responseTime;
            
            // Colorer les r√©ponses
            buttons.forEach((button, index) => {
                if (index === question.correct) {
                    button.classList.add('correct');
                } else if (index === selectedIndex) {
                    button.classList.add('incorrect');
                }
                button.onclick = null; // D√©sactiver les clics
            });
            
            // V√©rifier la r√©ponse
            if (selectedIndex === question.correct) {
                score++;
            }
            
            // Afficher l'explication
            const explanationElement = document.getElementById('explanation');
            explanationElement.innerHTML = `<strong>Explication :</strong> ${question.explanation}`;
            explanationElement.classList.add('show');
            
            // Afficher le bouton suivant
            document.getElementById('next-btn').classList.remove('hidden');
        }

        function nextQuestion() {
            currentQuestionIndex++;
            
            if (currentQuestionIndex < currentQuiz.length) {
                displayQuestion();
            } else {
                showResults();
            }
        }

        function showResults() {
            const percentage = Math.round((score / currentQuiz.length) * 100);
            
            // Mettre √† jour l'affichage des r√©sultats
            document.getElementById('score-text').textContent = `${percentage}%`;
            document.getElementById('correct-answers').textContent = score;
            document.getElementById('incorrect-answers').textContent = currentQuiz.length - score;
            document.getElementById('total-time').textContent = Math.round(totalTime / 1000) + 's';
            
            // Animer le cercle de score
            const scoreCircle = document.getElementById('score-circle');
            scoreCircle.style.setProperty('--score-percentage', `${percentage}%`);
            
            // Afficher la page des r√©sultats
            showPage('results');
        }

        // === LISTE DES QUESTIONS ===
        function displayQuestionsList() {
            const container = document.getElementById('questions-container');
            container.innerHTML = '';
            
            Object.entries(questionsData).forEach(([theme, questions]) => {
                // Cr√©er la section du th√®me
                const themeSection = document.createElement('div');
                themeSection.className = 'theme-section';
                
                // En-t√™te du th√®me
                const themeHeader = document.createElement('div');
                themeHeader.className = 'theme-header';
                themeHeader.innerHTML = `${theme} <small>(${questions.length} questions)</small>`;
                
                // Contenu du th√®me
                const themeContent = document.createElement('div');
                themeContent.className = 'theme-content';
                
                questions.forEach((question, index) => {
                    const questionItem = document.createElement('div');
                    questionItem.className = 'question-item';
                    
                    questionItem.innerHTML = `
                        <div class="question-text">${index + 1}. ${question.question}</div>
                        <div class="question-answer">
                            <div class="correct-answer">‚úì R√©ponse : ${question.answers[question.correct]}</div>
                            <div>${question.explanation}</div>
                        </div>
                    `;
                    
                    themeContent.appendChild(questionItem);
                });
                
                themeSection.appendChild(themeHeader);
                themeSection.appendChild(themeContent);
                container.appendChild(themeSection);
            });
        }

        // === GESTION DES √âV√âNEMENTS ===
        document.addEventListener('keydown', function(event) {
            // Permettre la navigation avec les touches num√©riques pendant le quiz
            if (document.getElementById('quiz').classList.contains('active')) {
                const key = event.key;
                if (key >= '1' && key <= '4') {
                    const answerIndex = parseInt(key) - 1;
                    const buttons = document.querySelectorAll('.answer-btn');
                    if (buttons[answerIndex] && timer) {
                        selectAnswer(answerIndex);
                    }
                }
            }
        });

        // Emp√™cher le clic droit et certaines touches pour √©viter la triche
        document.addEventListener('contextmenu', function(e) {
            if (document.getElementById('quiz').classList.contains('active')) {
                e.preventDefault();
            }
        });

        document.addEventListener('keydown', function(e) {
            if (document.getElementById('quiz').classList.contains('active')) {
                // Emp√™cher F12, Ctrl+Shift+I, etc.
                if (e.key === 'F12' || 
                    (e.ctrlKey && e.shiftKey && e.key === 'I') ||
                    (e.ctrlKey && e.shiftKey && e.key === 'C') ||
                    (e.ctrlKey && e.key === 'u')) {
                    e.preventDefault();
                }
            }
        });

        // === FONCTIONS UTILITAIRES ===
        function shuffleArray(array) {
            const newArray = [...array];
            for (let i = newArray.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
            }
            return newArray;
        }

        function formatTime(milliseconds) {
            const seconds = Math.floor(milliseconds / 1000);
            const minutes = Math.floor(seconds / 60);
            const remainingSeconds = seconds % 60;
            
            if (minutes > 0) {
                return `${minutes}m ${remainingSeconds}s`;
            }
            return `${remainingSeconds}s`;
        }

        // === SAUVEGARDE DES R√âSULTATS (simulation) ===
        function saveQuizResult() {
            const result = {
                date: new Date().toISOString(),
                score: score,
                total: currentQuiz.length,
                percentage: Math.round((score / currentQuiz.length) * 100),
                timeSpent: totalTime,
                theme: document.getElementById('theme-select').value
            };
            
            // Dans un vrai projet, on sauvegarderait en base de donn√©es
            console.log('R√©sultat du quiz:', result);
        }

        // === GESTION DES ERREURS ===
        window.addEventListener('error', function(e) {
            console.error('Erreur dans l\'application:', e.error);
            // Dans un environnement de production, on pourrait logger l'erreur
        });

        // === RESPONSIVE - GESTION DU REDIMENSIONNEMENT ===
        window.addEventListener('resize', function() {
            // Ajuster l'affichage si n√©cessaire
            if (window.innerWidth <= 768) {
                // Mode mobile
                document.body.classList.add('mobile');
            } else {
                document.body.classList.remove('mobile');
            }
        });

        // === PR√âCHARGEMENT DES DONN√âES ===
        function preloadData() {
            // V√©rifier que toutes les questions ont les bonnes propri√©t√©s
            Object.entries(questionsData).forEach(([theme, questions]) => {
                questions.forEach((question, index) => {
                    if (!question.question || !question.answers || typeof question.correct !== 'number' || !question.explanation) {
                        console.warn(`Question invalide d√©tect√©e dans ${theme}, question ${index + 1}`);
                    }
                });
            });
        }

        // === ACCESSIBILIT√â ===
        function setupAccessibility() {
            // Ajouter des attributs ARIA pour l'accessibilit√©
            document.querySelectorAll('.answer-btn').forEach((btn, index) => {
                btn.setAttribute('role', 'button');
                btn.setAttribute('aria-label', `R√©ponse ${index + 1}`);
                btn.setAttribute('tabindex', '0');
            });
        }

        // === ANIMATIONS D'ENTR√âE ===
        function animatePageEntry() {
            const activePagele = document.querySelector('.page.active');
            if (activePage) {
                activePage.style.opacity = '0';
                activePage.style.transform = 'translateY(20px)';
                
                setTimeout(() => {
                    activePage.style.transition = 'all 0.3s ease';
                    activePage.style.opacity = '1';
                    activePage.style.transform = 'translateY(0)';
                }, 10);
            }
        }

        // Initialisation finale
        document.addEventListener('DOMContentLoaded', function() {
            preloadData();
            setupAccessibility();
            
            // Ajouter une classe pour indiquer que JS est charg√©
            document.body.classList.add('js-loaded');
        });
    </script>
</body>
</html>
